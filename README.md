# YouTube Channel Video Metadata and Transcript Extractor

A Python tool to extract video metadata from YouTube channels and auto-generated transcripts from individual videos, designed for data analysis workflows.

## Features

- Extract comprehensive video metadata from entire YouTube channels.
- Extract auto-generated English transcripts from any YouTube video.
- Process a CSV list of videos to extract all their transcripts in bulk.
- Filter a channel's videos by a specified date range.
- Limit the number of recent videos to process from a channel.
- Save channel metadata to a CSV file.
- Save individual transcripts to clean text or markdown files.
- Command-line option to include or exclude timestamps in transcripts.
- Option to disable transcript deduplication logic for debugging.
- Robust logging for troubleshooting.

## Installation

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/yourusername/getYTchannelTranscripts.git
    cd getYTchannelTranscripts
    ```

2.  **Create and activate a virtual environment:**
    ```bash
    # For Unix/macOS
    python3 -m venv venv
    source venv/bin/activate

    # For Windows
    python -m venv venv
    venv\Scripts\activate
    ```

3.  **Install the package in editable mode:**

    This command uses the `setup.py` file to install the project and its dependencies, making the command-line scripts available in your environment. The `-e` flag means changes you make to the source code will take effect immediately without reinstalling.

    ```bash
    pip install -e .
    ```

4.  **Set up your environment variables:**
    Create a `.env` file in the root of the project by copying the example file:
    ```bash
    cp .env.example .env
    ```
    Open the `.env` file and add your Google API key:
    ```
    GOOGLE_API_KEY="YOUR_API_KEY_HERE"
    ```

5.  **(Optional) Install development dependencies:**
    If you plan to run tests or contribute to the code, install the development dependencies.
    ```bash
    pip install -e ".[dev]"
    ```

## Usage

The tool provides three main scripts for extracting data.

### 1. Extracting Channel Video Metadata

The `channel-videos-to-csv` script fetches video data from a channel and saves it to a CSV file. This is the first step for any bulk processing.

**Basic usage:**
*Note: The `--output` argument is required. By default, the script processes the 5 most recent videos.*
```bash
channel-videos-to-csv --channel "https://www.youtube.com/@MrBeast" --output "output/mrbeast_videos.csv"
```

**Limit to the 50 most recent videos:**
```bash
channel-videos-to-csv --channel "https://www.youtube.com/@MrBeast" --limit 50 --output "output/mrbeast_latest_50.csv"
```

**Get all videos from a channel:**
*Warning: Setting `--limit` to `-1` will retrieve all videos, which may take a very long time for channels with many uploads.*
```bash
channel-videos-to-csv --channel "https://www.youtube.com/@MrBeast" --limit -1 --output "output/mrbeast_all_videos.csv"
```

**Get videos from a specific date range:**
```bash
channel-videos-to-csv \
  --channel "https://www.youtube.com/@lexfridman" \
  --start-date "2023-01-01" \
  --end-date "2023-03-31" \
  --output "output/lex_q1_2023.csv"
```

### 2. Extracting a Single Video Transcript

The `extract-video-transcript` script downloads the auto-generated transcript for a single video.

**Basic usage:**
*This saves the transcript with timestamps to a generated filename in the `output/` directory.*
```bash
extract-video-transcript "https://www.youtube.com/watch?v=dQw4w9WgXcQ"
```

**Save to a specific file without timestamps:**
```bash
extract-video-transcript "https://www.youtube.com/watch?v=dQw4w9WgXcQ" --no-timestamps -o "output/my_transcript.txt"
```

**Save as Markdown with timestamps:**
```bash
extract-video-transcript "https://www.youtube.com/watch?v=dQw4w9WgXcQ" --format markdown -o "output/my_transcript.md"
```

**Disable transcript deduplication:**
*Useful for debugging or if you prefer the raw, rolling caption output.*
```bash
extract-video-transcript "https://www.youtube.com/watch?v=dQw4w9WgXcQ" --no-dedupe -o "output/dedupe_off.txt"
```

### 3. Processing a CSV of Videos to Get Transcripts

The `process-videos-from-csv` script reads a CSV file (like one generated by `channel-videos-to-csv`), and extracts the transcript for each video listed.

**Basic usage:**
*This will create a new directory `output/mrbeast_videos_transcripts/` and save each transcript as a separate text file inside it.*
```bash
process-videos-from-csv --csv-file "output/mrbeast_videos.csv"
```

**Specify a custom output directory and include timestamps:**
```bash
process-videos-from-csv \
  --csv-file "output/mrbeast_videos.csv" \
  --output-dir "transcripts/mrbeast" \
  --timestamps
```

### 4. Summarizing Video Transcripts

The `summarize-videos` script processes a CSV file of video metadata, reads the corresponding transcripts, and uses Google's Gemini API to generate a summary for each.

**Prerequisites:**
- You must have a `config.yaml` file with your desired LLM settings. An example is provided in the root directory.
- You must have a prompt template file. An example is provided at `prompts/summarize_transcript_prompt.md`.

**Basic usage:**
```bash
python scripts/summarize_videos.py \
    --csv-path ./transcripts/channel_videos_data.csv \
    --transcripts-dir ./transcripts/raw_transcripts \
    --output-dir ./transcripts/video_summaries \
    --prompt-path ./prompts/summarize_transcript_prompt.md \
    --config-path ./config.yaml \
    --limit 10
```

## Development

The project includes a comprehensive test suite and linting configuration.

### Running Tests and Linting

To run all checks (requires development dependencies):

```bash
# Run flake8 for code style checking
flake8 src tests

# Run black to format code
black src tests

# Run mypy for static type checking
mypy src

# Run pytest for unit tests
pytest
```

## Logging

Log files are stored in the `var/logs` directory by default. You can specify a different log file with the `--log` argument in any script.

-   `var/logs/app.log`: Default application log file.

## License

MIT License
